<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DIMER - Temperaturas por Venta Neta</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}body{font-family:'Segoe UI',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;padding:20px}.container{max-width:1400px;margin:0 auto;background:white;border-radius:20px;box-shadow:0 20px 60px rgba(0,0,0,0.3);overflow:hidden}.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);padding:30px;text-align:center;color:white}h1{font-size:2.5em;margin-bottom:10px}.subtitle{font-size:1.2em;opacity:0.9}.content{padding:40px}.refresh-button{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:15px 30px;border-radius:10px;font-size:16px;font-weight:bold;cursor:pointer;margin-bottom:30px;transition:all 0.3s}.refresh-button:hover{transform:translateY(-2px)}.toggle-container{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);border-radius:15px;padding:25px;margin-bottom:25px}.toggle-container h3{color:white;margin-bottom:15px;font-size:1.3em}.toggle-description{color:rgba(255,255,255,0.9);margin-bottom:20px;font-size:0.95em}.toggle-switch{display:flex;align-items:center;gap:20px;margin-bottom:15px}.toggle-label{color:white;font-weight:600;font-size:1.1em}.switch{position:relative;width:80px;height:40px;background:rgba(255,255,255,0.3);border-radius:20px;cursor:pointer;transition:all 0.3s}.switch.active{background:rgba(255,255,255,0.9)}.switch-slider{position:absolute;width:32px;height:32px;background:white;border-radius:50%;top:2px;left:2px;transition:all 0.3s}.switch.active .switch-slider{left:42px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}.toggle-info{background:rgba(255,255,255,0.2);padding:15px;border-radius:10px;color:white;font-size:0.9em}.filter-container{background:linear-gradient(135deg,#a8edea 0%,#fed6e3 100%);border-radius:15px;padding:25px;margin-bottom:25px}.filter-container h3{margin-bottom:15px}.filter-buttons{display:flex;flex-wrap:wrap;gap:10px}.filter-btn{padding:10px 20px;border:2px solid #667eea;background:white;border-radius:25px;cursor:pointer;font-weight:600;color:#667eea;transition:all 0.3s}.filter-btn.active{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white}.insights{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:30px}.insight-card{background:linear-gradient(135deg,#ffecd2 0%,#fcb69f 100%);border-radius:15px;padding:25px}.insight-card h4{color:#d84315;font-size:1.2em;margin-bottom:15px}.insight-value{font-size:2.5em;font-weight:bold;color:#bf360c;margin:10px 0}.insight-change{font-size:1.1em;color:#5d4037}.insight-change.positive{color:#d84315}.insight-change.negative{color:#1565c0}.table-container{overflow-x:auto;border-radius:15px;margin-bottom:30px}table{width:100%;border-collapse:collapse}thead{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white}th{padding:15px;text-align:left}th.temp-column{text-align:center}td{padding:12px 15px;border-bottom:1px solid #e0e0e0}tbody tr:hover{background:#f5f5f5}tbody tr.subtotal-row{background:#ede7f6;font-weight:bold}.comuna-cell{font-weight:600}.temp-cell{text-align:center;font-size:1.1em;font-weight:bold}.venta-cell{color:#666;font-size:0.9em}.change-cell{text-align:center;font-weight:600}.change-positive{color:#d84315}.change-negative{color:#1565c0}.top5-container{background:linear-gradient(135deg,#ffeaa7 0%,#fdcb6e 100%);border-radius:15px;padding:25px;margin-bottom:30px}.top5-list{display:grid;gap:10px}.top5-item{background:white;padding:15px;border-radius:10px;display:flex;justify-content:space-between}.top5-rank{font-size:1.5em;font-weight:bold;color:#e17055;width:40px}.top5-name{flex:1;font-weight:600}.top5-temp{font-size:1.3em;font-weight:bold;color:#d63031}.loading{text-align:center;padding:40px}.spinner{border:4px solid #f3f3f3;border-top:4px solid #667eea;border-radius:50%;width:50px;height:50px;animation:spin 1s linear infinite;margin:20px auto}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@media (max-width:768px){.insights{grid-template-columns:1fr}h1{font-size:1.8em}.content{padding:20px}}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>üå°Ô∏è An√°lisis de Temperaturas DIMER</h1>
<p class="subtitle">Ponderado por Venta Neta - Regi√≥n de Valpara√≠so</p>
</div>
<div class="content">
<button class="refresh-button" onclick="actualizarDatos()" id="refreshBtn">üîÑ Actualizar Datos</button>

<div class="toggle-container">
<h3>‚öñÔ∏è M√©todo de C√°lculo</h3>
<div class="toggle-description">Elige c√≥mo calcular los promedios de temperatura.</div>
<div class="toggle-switch">
<span class="toggle-label">Simple</span>
<div class="switch" id="ponderadoToggle" onclick="togglePonderado()">
<div class="switch-slider"></div>
</div>
<span class="toggle-label">Ponderado</span>
</div>
<div class="toggle-info">
<strong>Simple:</strong> Todas las comunas pesan igual<br>
<strong>Ponderado:</strong> Comunas con m√°s ventas pesan m√°s
</div>
</div>

<div class="filter-container">
<h3>üîç Filtrar por Provincia</h3>
<div class="filter-buttons">
<button class="filter-btn active" onclick="filtrarProvincia('TODAS')">Todas</button>
<button class="filter-btn" onclick="filtrarProvincia('DIMER')">DIMER</button>
<button class="filter-btn" onclick="filtrarProvincia('OTRAS')">OTRAS</button>
<button class="filter-btn" onclick="filtrarProvincia('Valpara√≠so')">Valpara√≠so</button>
<button class="filter-btn" onclick="filtrarProvincia('Marga Marga')">Marga Marga</button>
<button class="filter-btn" onclick="filtrarProvincia('Quillota')">Quillota</button>
<button class="filter-btn" onclick="filtrarProvincia('San Felipe')">San Felipe</button>
<button class="filter-btn" onclick="filtrarProvincia('Los Andes')">Los Andes</button>
</div>
</div>

<div class="insights">
<div class="insight-card">
<h4>üéØ Zona DIMER</h4>
<div class="insight-value" id="dimerTemp">--¬∞C</div>
<div class="insight-change" id="dimerChange">Variaci√≥n: --</div>
<div style="margin-top:10px;color:#666;font-size:0.9em" id="dimerInfo">Ventas: --</div>
</div>
<div class="insight-card">
<h4>üåç Otras Zonas</h4>
<div class="insight-value" id="otrasTemp">--¬∞C</div>
<div class="insight-change" id="otrasChange">Variaci√≥n: --</div>
<div style="margin-top:10px;color:#666;font-size:0.9em" id="otrasInfo">Ventas: --</div>
</div>
</div>

<div class="top5-container" id="top5Container"></div>

<div class="table-container">
<table>
<thead>
<tr>
<th>Comuna</th>
<th>Provincia</th>
<th class="temp-column">Temp. Actual<br><span id="currentDate">--</span></th>
<th class="temp-column">Temp. Anterior<br><span id="previousDate">--</span></th>
<th class="temp-column">Variaci√≥n</th>
<th>Venta Neta Nov 2024</th>
</tr>
</thead>
<tbody id="tableBody">
<tr><td colspan="6" class="loading"><div class="spinner"></div>Cargando...</td></tr>
</tbody>
</table>
</div>
</div>
</div>

<script>
const ventasData = {
"ALGARROBO": 40109118,
"CABILDO": 23261597,
"CALLE LARGA": 12692845,
"CARTAGENA": 24000831,
"CASABLANCA": 36179345,
"CATEMU": 18685339,
"CONCON": 43316836,
"CURACAVI": 33436083,
"EL QUISCO": 34914158,
"EL TABO": 20870159,
"HIJUELAS": 28654980,
"ILLAPEL": 36184151,
"LA CALERA": 43349171,
"LA CRUZ": 20531433,
"LA LIGUA": 45495504,
"LIMACHE": 53296589,
"LLAY LLAY": 37584413,
"LOS ANDES": 76323074,
"LOS VILOS": 35626556,
"MARIA PINTO": 13805094,
"MELIPILLA": 114558107,
"NOGALES": 19477480,
"OLMUE": 27337219,
"PANQUEHUE": 11926739,
"PAPUDO": 11993620,
"PETORCA": 11874334,
"PUCHUNCAVI": 28347751,
"PUTAENDO": 19635479,
"QUILLOTA": 70713481,
"QUILPUE": 115108130,
"QUINTERO": 23306251,
"RINCONADA": 20046378,
"SALAMANCA": 20545076,
"SAN ANTONIO": 69552087,
"SAN ESTEBAN": 17458034,
"SAN FELIPE": 77452377,
"SANTA MARIA": 11455420,
"SANTO DOMINGO": 17115238,
"VALPARAISO": 184704766,
"VILLA ALEMANA": 88806010,
"VI√ëA DEL MAR": 325221662,
"ZAPALLAR": 15106280
};

const comunasData = {
"VALPARAISO": { lat: -33.0458, lon: -71.6197, provincia: "Valpara√≠so", zona: "DIMER" },
"VI√ëA DEL MAR": { lat: -33.0246, lon: -71.5518, provincia: "Valpara√≠so", zona: "DIMER" },
"QUILPUE": { lat: -33.0472, lon: -71.4425, provincia: "Marga Marga", zona: "DIMER" },
"VILLA ALEMANA": { lat: -33.0442, lon: -71.3728, provincia: "Marga Marga", zona: "DIMER" },
"LIMACHE": { lat: -33.0167, lon: -71.2667, provincia: "Marga Marga", zona: "DIMER" },
"OLMUE": { lat: -33.0000, lon: -71.2000, provincia: "Marga Marga", zona: "DIMER" },
"CONCON": { lat: -32.9253, lon: -71.5189, provincia: "Valpara√≠so", zona: "OTRAS" },
"QUINTERO": { lat: -32.7833, lon: -71.5333, provincia: "Valpara√≠so", zona: "OTRAS" },
"PUCHUNCAVI": { lat: -32.7333, lon: -71.4167, provincia: "Valpara√≠so", zona: "OTRAS" },
"CASABLANCA": { lat: -33.3167, lon: -71.4167, provincia: "Valpara√≠so", zona: "OTRAS" },
"ALGARROBO": { lat: -33.3667, lon: -71.6667, provincia: "San Antonio", zona: "OTRAS" },
"CARTAGENA": { lat: -33.5500, lon: -71.6083, provincia: "San Antonio", zona: "OTRAS" },
"EL QUISCO": { lat: -33.3950, lon: -71.7022, provincia: "San Antonio", zona: "OTRAS" },
"EL TABO": { lat: -33.4500, lon: -71.6500, provincia: "San Antonio", zona: "OTRAS" },
"SAN ANTONIO": { lat: -33.5957, lon: -71.6184, provincia: "San Antonio", zona: "OTRAS" },
"SANTO DOMINGO": { lat: -33.6500, lon: -71.6167, provincia: "San Antonio", zona: "OTRAS" },
"QUILLOTA": { lat: -32.8833, lon: -71.2500, provincia: "Quillota", zona: "OTRAS" },
"LA CALERA": { lat: -32.7833, lon: -71.2000, provincia: "Quillota", zona: "OTRAS" },
"HIJUELAS": { lat: -32.8167, lon: -71.1667, provincia: "Quillota", zona: "OTRAS" },
"LA CRUZ": { lat: -32.8333, lon: -71.2167, provincia: "Quillota", zona: "OTRAS" },
"NOGALES": { lat: -32.7333, lon: -71.1833, provincia: "Quillota", zona: "OTRAS" },
"SAN FELIPE": { lat: -32.7500, lon: -70.7333, provincia: "San Felipe", zona: "OTRAS" },
"LLAY LLAY": { lat: -32.8333, lon: -70.9667, provincia: "San Felipe", zona: "OTRAS" },
"PANQUEHUE": { lat: -32.8167, lon: -70.8500, provincia: "San Felipe", zona: "OTRAS" },
"PUTAENDO": { lat: -32.6167, lon: -70.7167, provincia: "San Felipe", zona: "OTRAS" },
"SANTA MARIA": { lat: -32.7500, lon: -70.6667, provincia: "San Felipe", zona: "OTRAS" },
"CATEMU": { lat: -32.7833, lon: -70.8833, provincia: "San Felipe", zona: "OTRAS" },
"LOS ANDES": { lat: -32.8333, lon: -70.6000, provincia: "Los Andes", zona: "OTRAS" },
"CALLE LARGA": { lat: -32.8667, lon: -70.6167, provincia: "Los Andes", zona: "OTRAS" },
"RINCONADA": { lat: -32.8333, lon: -70.6500, provincia: "Los Andes", zona: "OTRAS" },
"SAN ESTEBAN": { lat: -32.7833, lon: -70.5833, provincia: "Los Andes", zona: "OTRAS" },
"LA LIGUA": { lat: -32.4500, lon: -71.2333, provincia: "Petorca", zona: "OTRAS" },
"PETORCA": { lat: -32.2667, lon: -70.9333, provincia: "Petorca", zona: "OTRAS" },
"CABILDO": { lat: -32.4167, lon: -71.0833, provincia: "Petorca", zona: "OTRAS" },
"PAPUDO": { lat: -32.5167, lon: -71.4500, provincia: "Petorca", zona: "OTRAS" },
"ZAPALLAR": { lat: -32.5500, lon: -71.4667, provincia: "Petorca", zona: "OTRAS" },
"ILLAPEL": { lat: -31.6333, lon: -71.1667, provincia: "Choapa", zona: "OTRAS" },
"SALAMANCA": { lat: -31.7667, lon: -70.9667, provincia: "Choapa", zona: "OTRAS" },
"LOS VILOS": { lat: -31.9167, lon: -71.5167, provincia: "Choapa", zona: "OTRAS" },
"MELIPILLA": { lat: -33.6833, lon: -71.2167, provincia: "Melipilla", zona: "OTRAS" },
"CURACAVI": { lat: -33.4000, lon: -71.1333, provincia: "Melipilla", zona: "OTRAS" },
"MARIA PINTO": { lat: -33.5167, lon: -71.1333, provincia: "Melipilla", zona: "OTRAS" }
};

let usePonderado = false;
let filtroActual = 'TODAS';
let datosTemperaturas = [];

function togglePonderado() {
usePonderado = !usePonderado;
document.getElementById('ponderadoToggle').classList.toggle('active');
calcularYMostrarDatos();
}

function filtrarProvincia(filtro) {
filtroActual = filtro;
document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
event.target.classList.add('active');
calcularYMostrarDatos();
}

function formatCurrency(num) {
return '$' + new Intl.NumberFormat('es-CL').format(Math.round(num));
}

function calcularPromedio(datos, campo) {
if (datos.length === 0) return 0;
if (usePonderado) {
let sumaProductos = 0;
let sumaVentas = 0;
datos.forEach(d => {
if (d[campo] !== null && d[campo] !== undefined) {
const venta = ventasData[d.nombre] || 0;
sumaProductos += d[campo] * venta;
sumaVentas += venta;
}
});
return sumaVentas > 0 ? sumaProductos / sumaVentas : 0;
} else {
const suma = datos.reduce((acc, d) => {
const val = d[campo];
return acc + (val !== null && val !== undefined ? val : 0);
}, 0);
return suma / datos.length;
}
}

function actualizarInsights(tempActual, tempAnterior, datos, tipo) {
const variacion = tempActual - tempAnterior;
const variacionPct = ((variacion / tempAnterior) * 100).toFixed(1);
const totalVentas = datos.reduce((acc, d) => acc + (ventasData[d.nombre] || 0), 0);
document.getElementById(tipo + 'Temp').textContent = tempActual.toFixed(2) + '¬∞C';
document.getElementById(tipo + 'Change').textContent = 
`Variaci√≥n: ${variacion > 0 ? '+' : ''}${variacion.toFixed(2)}¬∞C (${variacion > 0 ? '+' : ''}${variacionPct}%)`;
document.getElementById(tipo + 'Change').className = 
'insight-change ' + (variacion > 0 ? 'positive' : 'negative');
document.getElementById(tipo + 'Info').textContent = 
`Ventas: ${formatCurrency(totalVentas)} | ${datos.length} comunas`;
}

function mostrarTop5(datos) {
const top5 = [...datos]
.filter(d => d.tempActual !== null)
.sort((a, b) => b.tempActual - a.tempActual)
.slice(0, 5);
const html = `
<h3>üî• Top 5 Comunas M√°s C√°lidas</h3>
<div class="top5-list">
${top5.map((item, index) => `
<div class="top5-item">
<div class="top5-rank">#${index + 1}</div>
<div class="top5-name">${item.nombre}</div>
<div class="top5-temp">${item.tempActual.toFixed(1)}¬∞C</div>
</div>
`).join('')}
</div>
`;
document.getElementById('top5Container').innerHTML = html;
}

function mostrarTabla(datos, dimerActual, dimerAnterior, otrasActual, otrasAnterior) {
datos.sort((a, b) => {
if (a.zona !== b.zona) return a.zona === 'DIMER' ? -1 : 1;
return a.nombre.localeCompare(b.nombre);
});
let html = '';
let ultimaZona = null;
datos.forEach(item => {
if (item.zona !== ultimaZona && filtroActual === 'TODAS') {
if (ultimaZona !== null) {
const tempActual = ultimaZona === 'DIMER' ? dimerActual : otrasActual;
const tempAnterior = ultimaZona === 'DIMER' ? dimerAnterior : otrasAnterior;
const variacion = tempActual - tempAnterior;
const datosZona = datosTemperaturas.filter(d => d.zona === ultimaZona);
const ventasZona = datosZona.reduce((acc, d) => acc + (ventasData[d.nombre] || 0), 0);
html += `
<tr class="subtotal-row">
<td colspan="2"><strong>Subtotal ${ultimaZona}</strong> (${usePonderado ? 'Ponderado' : 'Simple'})</td>
<td class="temp-cell">${tempActual.toFixed(2)}¬∞C</td>
<td class="temp-cell">${tempAnterior.toFixed(2)}¬∞C</td>
<td class="change-cell ${variacion >= 0 ? 'change-positive' : 'change-negative'}">
${variacion > 0 ? '+' : ''}${variacion.toFixed(2)}¬∞C
</td>
<td class="venta-cell">${formatCurrency(ventasZona)}</td>
</tr>
`;
}
ultimaZona = item.zona;
}
const variacion = item.tempActual - item.tempAnterior;
const venta = ventasData[item.nombre] || 0;
html += `
<tr>
<td class="comuna-cell">${item.nombre}</td>
<td>${item.provincia}</td>
<td class="temp-cell">${item.tempActual !== null ? item.tempActual.toFixed(1) + '¬∞C' : 'N/D'}</td>
<td class="temp-cell">${item.tempAnterior !== null ? item.tempAnterior.toFixed(1) + '¬∞C' : 'N/D'}</td>
<td class="change-cell ${variacion >= 0 ? 'change-positive' : 'change-negative'}">
${item.tempActual !== null && item.tempAnterior !== null ? 
(variacion > 0 ? '+' : '') + variacion.toFixed(1) + '¬∞C' : 'N/D'}
</td>
<td class="venta-cell">${formatCurrency(venta)}</td>
</tr>
`;
});
if (filtroActual === 'TODAS' && ultimaZona !== null) {
const tempActual = ultimaZona === 'DIMER' ? dimerActual : otrasActual;
const tempAnterior = ultimaZona === 'DIMER' ? dimerAnterior : otrasAnterior;
const variacion = tempActual - tempAnterior;
const datosZona = datosTemperaturas.filter(d => d.zona === ultimaZona);
const ventasZona = datosZona.reduce((acc, d) => acc + (ventasData[d.nombre] || 0), 0);
html += `
<tr class="subtotal-row">
<td colspan="2"><strong>Subtotal ${ultimaZona}</strong> (${usePonderado ? 'Ponderado' : 'Simple'})</td>
<td class="temp-cell">${tempActual.toFixed(2)}¬∞C</td>
<td class="temp-cell">${tempAnterior.toFixed(2)}¬∞C</td>
<td class="change-cell ${variacion >= 0 ? 'change-positive' : 'change-negative'}">
${variacion > 0 ? '+' : ''}${variacion.toFixed(2)}¬∞C
</td>
<td class="venta-cell">${formatCurrency(ventasZona)}</td>
</tr>
`;
}
document.getElementById('tableBody').innerHTML = html;
}

function calcularYMostrarDatos() {
if (datosTemperaturas.length === 0) return;
let datosFiltrados = datosTemperaturas;
if (filtroActual === 'DIMER') {
datosFiltrados = datosTemperaturas.filter(d => d.zona === 'DIMER');
} else if (filtroActual === 'OTRAS') {
datosFiltrados = datosTemperaturas.filter(d => d.zona === 'OTRAS');
} else if (filtroActual !== 'TODAS') {
datosFiltrados = datosTemperaturas.filter(d => d.provincia === filtroActual);
}
const datosDimer = datosTemperaturas.filter(d => d.zona === 'DIMER');
const datosOtras = datosTemperaturas.filter(d => d.zona === 'OTRAS');
const dimerActual = calcularPromedio(datosDimer, 'tempActual');
const dimerAnterior = calcularPromedio(datosDimer, 'tempAnterior');
const otrasActual = calcularPromedio(datosOtras, 'tempActual');
const otrasAnterior = calcularPromedio(datosOtras, 'tempAnterior');
actualizarInsights(dimerActual, dimerAnterior, datosDimer, 'dimer');
actualizarInsights(otrasActual, otrasAnterior, datosOtras, 'otras');
mostrarTop5(datosTemperaturas);
mostrarTabla(datosFiltrados, dimerActual, dimerAnterior, otrasActual, otrasAnterior);
}

async function obtenerTemperaturas() {
const hoy = new Date();
const ayer = new Date(hoy);
ayer.setDate(ayer.getDate() - 1);
const a√±oAnterior = new Date(hoy);
a√±oAnterior.setFullYear(a√±oAnterior.getFullYear() - 1);
const formatFecha = (fecha) => fecha.toISOString().split('T')[0];
const fechaActual = formatFecha(ayer);
const fechaAnterior = formatFecha(a√±oAnterior);
document.getElementById('currentDate').textContent = ayer.toLocaleDateString('es-CL');
document.getElementById('previousDate').textContent = a√±oAnterior.toLocaleDateString('es-CL');
datosTemperaturas = [];
for (const [nombre, datos] of Object.entries(comunasData)) {
try {
const urlActual = `https://archive-api.open-meteo.com/v1/archive?latitude=${datos.lat}&longitude=${datos.lon}&start_date=${fechaActual}&end_date=${fechaActual}&daily=temperature_2m_max&timezone=America/Santiago`;
const resActual = await fetch(urlActual);
const dataActual = await resActual.json();
const tempActual = dataActual.daily?.temperature_2m_max?.[0] || null;
const urlAnterior = `https://archive-api.open-meteo.com/v1/archive?latitude=${datos.lat}&longitude=${datos.lon}&start_date=${fechaAnterior}&end_date=${fechaAnterior}&daily=temperature_2m_max&timezone=America/Santiago`;
const resAnterior = await fetch(urlAnterior);
const dataAnterior = await resAnterior.json();
const tempAnterior = dataAnterior.daily?.temperature_2m_max?.[0] || null;
datosTemperaturas.push({
nombre: nombre,
provincia: datos.provincia,
zona: datos.zona,
tempActual: tempActual,
tempAnterior: tempAnterior
});
await new Promise(resolve => setTimeout(resolve, 100));
} catch (error) {
console.error(`Error obteniendo datos para ${nombre}:`, error);
datosTemperaturas.push({
nombre: nombre,
provincia: datos.provincia,
zona: datos.zona,
tempActual: null,
tempAnterior: null
});
}
}
calcularYMostrarDatos();
}

async function actualizarDatos() {
const btn = document.getElementById('refreshBtn');
btn.disabled = true;
btn.textContent = '‚è≥ Actualizando...';
document.getElementById('tableBody').innerHTML = `
<tr>
<td colspan="6" class="loading">
<div class="spinner"></div>
Cargando datos de temperatura...
</td>
</tr>
`;
try {
await obtenerTemperaturas();
btn.textContent = '‚úÖ Datos Actualizados';
setTimeout(() => {
btn.textContent = 'üîÑ Actualizar Datos';
btn.disabled = false;
}, 2000);
} catch (error) {
console.error('Error actualizando datos:', error);
btn.textContent = '‚ùå Error al Actualizar';
setTimeout(() => {
btn.textContent = 'üîÑ Actualizar Datos';
btn.disabled = false;
}, 2000);
}
}

setInterval(() => actualizarDatos(), 24 * 60 * 60 * 1000);
window.addEventListener('load', () => obtenerTemperaturas());
</script>
</body>
</html>
